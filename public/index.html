<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Incognito</title>
  <link rel="icon" type="image/png" href="images/favicon.png">
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" rel="stylesheet">
</head>
<body>

  <div class="corner-logo"><img src="images/logo.png" alt="Incognito"></div>

  <div id="ejectionOverlay" class="lobby-overlay" style="display: none;">
    <div class="result-card">
      <div id="resultIcon" style="font-size: 4rem; margin-bottom: 10px;">锔</div>
      <h1 id="resultTitle" class="result-title">RESULTADO</h1>
      <p id="resultSubtitle" style="color:#888; margin-bottom:20px;">...</p>
      <div id="finalDetailsBox" style="background:rgba(255,255,255,0.03); padding:15px; border-radius:10px; margin-bottom:20px; display:none;">
        <div style="display:flex; justify-content:space-between; margin-bottom:6px; font-size:0.95rem;">
          <span style="color:#aaa;">Ganadores:</span>
          <span id="finalWinners" style="color:var(--primary); font-weight:bold;">---</span>
        </div>
        <div style="display:flex; justify-content:space-between; margin-bottom:6px; font-size:0.95rem;">
          <span style="color:#aaa;">Impostores:</span>
          <span id="finalImpostors" style="color:var(--accent-red); font-weight:bold;">---</span>
        </div>
      </div>
      <button id="btnBackToLobby" class="btn-main btn-primary">CONTINUAR</button>
    </div>
  </div>

  <div id="lobbyOverlay" class="lobby-overlay">
    
    <div id="screenHome" class="screen fade-in center-layout">
      <div class="brand-header"><img src="images/logo.png" alt="Incognito" class="logo-img"></div>
      <div class="home-menu-panel">
        <button id="btnGoCreate" class="btn-big btn-primary">CREAR SALA</button>
        <button id="btnGoJoin" class="btn-big btn-secondary">UNIRSE A SALA</button>
        <button id="btnDiscordGlobal" class="btn-big" style="background:rgba(15,23,42,0.9); border:1px solid rgba(88,101,242,0.7); color:#E8FFFF; display:flex; align-items:center; justify-content:center; gap:10px;">
             <img src="https://assets-global.website-files.com/6257adef93867e56f84d3092/639cf127bf92de1e2_icon_clyde_blurple_RGB.png" width="24" style="filter: brightness(100);"> COMUNIDAD
        </button>
      </div>
    </div>

    <div id="screenCreate" class="screen fade-in center-layout" style="display: none;">
      <div class="screen-header">
        <button id="backFromCreate" class="btn-icon-back"><img src="images/arrow.png" alt="Volver"></button>
        <h2>CONFIGURAR</h2>
      </div>
      <div class="config-width" style="flex:1; overflow-y:auto;">
        <div class="app-card">
          <label>TU NOMBRE</label>
          <input type="text" id="hostName" class="input-modern" maxlength="12" placeholder="Agente...">
        </div>

        <div class="config-grid">
          <div class="app-card" style="text-align:center;">
            <label>JUGADORES</label>
            <div class="inline-center">
              <button class="btn-circle" onclick="adjustValue('maxPlayers', -1)">-</button>
              <div class="value-display" id="displayPlayers">10</div>
              <button class="btn-circle" onclick="adjustValue('maxPlayers', 1)">+</button>
            </div>
            <small class="hint">M谩x. 15 jugadores</small>
            <input type="hidden" id="maxPlayers" value="10">
          </div>

          <div class="app-card" style="text-align:center;">
            <label>IMPOSTORES</label>
            <div class="inline-center">
              <button class="btn-circle" onclick="adjustValue('impostors', -1)">-</button>
              <div class="value-display" id="displayImpostors">2</div>
              <button class="btn-circle" onclick="adjustValue('impostors', 1)">+</button>
            </div>
            <small class="hint">Entre 1 y 4, siempre menos que los jugadores</small>
            <input type="hidden" id="impostors" value="2">
          </div>

          <div class="app-card">
            <label>TIEMPO DE VOTACIN (segundos)</label>
            <div class="inline-center">
              <button class="btn-circle" onclick="adjustValue('timeVote', -15)">-</button>
              <div class="value-display" id="displayVoteTime">120</div>
              <button class="btn-circle" onclick="adjustValue('timeVote', 15)">+</button>
            </div>
            <small class="hint">Entre 60 y 300 segundos</small>
            <input type="hidden" id="timeVote" value="120">
          </div>
        </div>

        <div class="app-card">
          <label>CATEGORAS</label>
          <div id="categoriesGrid" class="categories-grid">
            <!-- Se llena por JS -->
          </div>
        </div>

        <div class="app-card" style="margin-top:10px;">
          <button id="btnCreateRoom" class="btn-main btn-primary">CREAR SALA</button>
        </div>
      </div>
    </div>

    <div id="screenJoin" class="screen fade-in center-layout" style="display: none;">
      <div class="screen-header">
        <button id="backFromJoin" class="btn-icon-back"><img src="images/arrow.png" alt="Volver"></button>
        <h2>UNIRSE</h2>
      </div>
      <div class="config-width" style="flex:1; overflow-y:auto;">
        <div class="app-card">
          <label>TU NOMBRE</label>
          <input type="text" id="joinName" class="input-modern" maxlength="12" placeholder="Agente...">
        </div>
        <div class="app-card">
          <label>CDIGO DE SALA</label>
          <input type="text" id="joinCode" class="input-modern" maxlength="6" placeholder="ABC123" style="text-align:center; letter-spacing:3px;">
        </div>
        <div class="app-card">
          <button id="btnJoinRoom" class="btn-main btn-primary">UNIRSE A LA SALA</button>
        </div>
      </div>
    </div>

  </div>

  <main id="mainContent" style="display:none;">
    <div class="main-layout">
      <div class="top-bar">
        <div class="room-code-pill">
          <span>SALA</span>
          <strong id="roomCodeDisplay">-----</strong>
          <button id="btnCopyCode" class="btn-icon-simple" title="Copiar c贸digo"></button>
        </div>
        <div class="top-center-status">
          <span id="phaseLabel" class="phase-label">LOBBY</span>
          <span id="timerLabel" class="timer-label">--</span>
        </div>
        <div class="header-actions">
          <button id="btnDiscordManual" class="btn-discord">
            <img src="images/discord.png" width="20" alt="Discord">
          </button>
          <button id="btnExit" class="btn-icon-simple" style="background:rgba(148,27,44,0.15); border:1px solid rgba(248,113,113,0.6);">Salir</button>
        </div>
      </div>

      <div class="main-grid">
        <section class="game-center">
          <div id="viewPanel" class="view-panel">
            
            <div id="viewLobby" class="view-card">
              <h2>Esperando jugadores...</h2>
              <p class="subtitle">Comparte el c贸digo de sala para que tus amigos se unan.</p>
              <div class="lobby-info">
                <div>
                  <span class="label">Jugadores actuales</span>
                  <span id="currentPlayersCount" class="value">1</span>
                </div>
                <div>
                  <span class="label">Impostores</span>
                  <span id="currentImpostorsCount" class="value">2</span>
                </div>
              </div>
              <div class="status-box">
                <h3>C贸mo funciona</h3>
                <div class="rules-text">
                  <p><strong>1.</strong> Todos reciben una palabra secreta, menos el impostor.</p>
                  <p><strong>2.</strong> Cada uno debe decir una pista sin revelar la palabra.</p>
                  <p><strong>3.</strong> Se vota qui茅n se cree que es el impostor.</p>
                  <p><strong>4.</strong> Si lo descubren, gana la tripulaci贸n. Si no, gana el impostor.</p>
                </div>
                <div class="loading-bar"><div class="bar-fill"></div></div>
              </div>
              <div class="lobby-actions">
                <button id="btnStartRound" class="btn-main btn-primary">INICIAR RONDA</button>
              </div>
            </div>

            <div id="viewWord" class="view-card" style="display:none;">
              <div class="secret-card-wrapper" id="secretCard">
                <div class="secret-card-inner">
                  <div class="secret-card front">
                    <div class="lock-icon"></div>
                    <div class="lock-title">TOCA PARA VER</div>
                    <p class="lock-subtitle">Tu rol y pista aparecer谩n aqu铆.</p>
                  </div>
                  <div class="secret-card back">
                    <div id="roleTitle" class="role-title">TRIPULANTE</div>
                    <div id="secretWordDisplay" class="secret-word">PALABRA</div>
                    <p id="wordHint" class="word-hint">No reveles la palabra exacta, solo da pistas.</p>
                  </div>
                </div>
              </div>
              <p class="hint" style="margin-top:20px;">Cuando todos hayan visto su rol, comenzar谩 el turno de pistas.</p>
            </div>

            <div id="viewTurn" class="view-card" style="display:none;">
              <h2 id="turnTitle">Tu turno</h2>
              <p id="turnInstruction" class="subtitle">Di una pista relacionada con la palabra.</p>
              <div id="turnStatus" class="status-box small">
                <h3>Turno actual</h3>
                <p id="currentTurnPlayer">Esperando...</p>
              </div>
            </div>

            <div id="viewVote" class="view-card" style="display:none;">
              <h2>VOTACIN</h2>
              <p class="subtitle" id="voteSubtitle">Elige qui茅n crees que es el impostor.</p>
              <div id="votePlayersGrid" class="vote-grid">
                <!-- Llenado por JS -->
              </div>
            </div>

          </div>
        </section>

        <aside class="players-panel">
          <div class="players-card">
            <div class="sidebar-header">TRIPULACIN</div>
            <div id="playersList" class="players-list">
              <!-- Jugadores -->
            </div>
          </div>
          <div class="players-card" style="margin-top:10px;">
            <div class="sidebar-header">ESTADO</div>
            <p id="statusText" style="font-size:0.85rem; color:#9ca3af;">Esperando ronda...</p>
          </div>
        </aside>
      </div>
    </div>
  </main>

  <script src="/socket.io/socket.io.js"></script>
  <script src="game.js"></script>
</body>
</html>
