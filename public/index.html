<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Incognito</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800;900&display=swap" rel="stylesheet">
</head>
<body>
  <audio id="soundClick" src="sounds/click.mp3" preload="auto"></audio>
  <audio id="soundFlip" src="sounds/flip.mp3" preload="auto"></audio>
  <audio id="soundWin" src="sounds/win.mp3" preload="auto"></audio>
  <audio id="soundLose" src="sounds/lose.mp3" preload="auto"></audio>

  <div id="ejectionOverlay" class="full-overlay" style="display: none;">
    <div class="result-card">
      <div id="resultIcon" style="font-size: 4rem; text-align:center;"></div>
      <h1 id="resultTitle" class="result-title">---</h1>
      <p id="resultSubtitle" style="text-align:center;">---</p>
      <div style="background:#0f172a; padding:15px; border-radius:10px; margin:20px 0;">
        <div class="result-row"><span>Palabra:</span><span id="finalSecretWord" class="result-value">---</span></div>
        <div class="result-row"><span>Impostores:</span><span id="finalImpostors" class="result-value highlight">---</span></div>
      </div>
      <button id="btnBackToLobby" class="btn-main btn-primary" style="width:100%">CONTINUAR</button>
    </div>
  </div>

  <div id="howToPlayOverlay" class="full-overlay" style="display:none;">
    <div class="howto-card">
      <h2 style="text-align:center; margin-bottom:20px;">C√≥mo Jugar</h2>
      <div class="howto-item"><div class="howto-icon">üëÅÔ∏è</div><div class="howto-text"><h3>Revelar Palabras</h3><p>Todos ven su palabra excepto el impostor - ellos solo ven la categor√≠a.</p></div></div>
      <div class="howto-item"><div class="howto-icon">üí¨</div><div class="howto-text"><h3>Dar Pistas</h3><p>Turnense para decir palabras relacionadas. ¬°Traten de no ser demasiado obvios!</p></div></div>
      <div class="howto-item"><div class="howto-icon">üîç</div><div class="howto-text"><h3>Encontrar al Impostor</h3><p>Discutan y voten qui√©n no conoce la palabra. ¬°Si se equivocan, gana el impostor!</p></div></div>
      <button id="btnCloseHowToPlay" class="btn-main btn-primary" style="width:100%;">ENTENDIDO</button>
    </div>
  </div>

  <div id="lobbyOverlay" class="lobby-overlay">
    <button id="btnHowToPlay" style="position:absolute; top:20px; right:20px; background:#334155; border:none; color:white; width:30px; height:30px; border-radius:50%; cursor:pointer; font-weight:bold;">?</button>

    <div id="screenHome" class="screen-wrapper-home">
      <div class="big-logo-container"><img src="images/logo.png" alt="Incognito" class="logo-img-home"></div>
      <div class="home-card-buttons">
        <button id="btnGoCreate" class="btn-big btn-main btn-primary">CREAR SALA</button>
        <button id="btnGoJoin" class="btn-big btn-main btn-secondary">UNIRSE A SALA</button>
      </div>
    </div>

    <div id="screenCreate" class="screen" style="display:none;">
      <div class="screen-header">
        <button id="backFromCreate" class="btn-icon-back"><img src="images/arrow.png" class="arrow-icon-img" alt="Volver"></button>
        <h2>Crear Sala</h2>
      </div>
      <div class="app-card">
        <input type="text" id="hostName" class="input-modern" maxlength="12" placeholder="Tu Nombre...">
      </div>
      <div class="config-counters">
        <div class="mini-card"><span class="mini-label">JUGADORES</span><div class="mini-controls"><button class="btn-circle" onclick="adjustValue('maxPlayers', -1)">-</button><div class="value-display" id="displayPlayers">10</div><button class="btn-circle" onclick="adjustValue('maxPlayers', 1)">+</button></div><span class="mini-hint-simple">M√°x. 15</span><input type="hidden" id="maxPlayers" value="10"></div>
        <div class="mini-card"><span class="mini-label">IMPOSTORES</span><div class="mini-controls"><button class="btn-circle" onclick="adjustValue('impostors', -1)">-</button><div class="value-display" id="displayImpostors">2</div><button class="btn-circle" onclick="adjustValue('impostors', 1)">+</button></div><span class="mini-hint-simple">1 - 4</span><input type="hidden" id="impostors" value="2"></div>
        <div class="mini-card"><span class="mini-label">TIEMPO</span><div class="mini-controls"><button class="btn-circle" onclick="adjustValue('timeVote', -15)">-</button><div class="value-display" id="displayVoteTime">120</div><button class="btn-circle" onclick="adjustValue('timeVote', 15)">+</button></div><span class="mini-hint-simple">Segundos</span><input type="hidden" id="timeVote" value="120"></div>
      </div>
      <div class="app-card row-between"><div style="overflow:hidden; flex:1;"><span class="mini-label">CATEGOR√çAS</span><div id="categoriesSummary" style="font-size:0.8rem; color:#cbd5e1;">...</div></div><button id="btnOpenCategories" style="background:#3b82f6; border:none; color:white; padding:8px 15px; border-radius:8px; cursor:pointer; font-weight:600;">Elegir</button></div>
      <div class="app-card row-between"><span class="mini-label">MODO GRUPAL (Sin Discord)</span><div class="toggle-wrapper"><input type="checkbox" id="groupModeToggle"><span class="toggle-slider"></span></div></div>
      <button id="btnCreateRoom" class="btn-big btn-main btn-primary">CREAR SALA</button>
    </div>

    <div id="screenJoin" class="screen" style="display:none;">
      <div class="screen-header">
        <button id="backFromJoin" class="btn-icon-back"><img src="images/arrow.png" class="arrow-icon-img" alt="Volver"></button>
        <h2>Unirse</h2>
      </div>
      <div class="app-card"><input type="text" id="joinName" class="input-modern" maxlength="12" placeholder="Tu Nombre..."></div>
      <div class="app-card"><input type="text" id="joinCode" class="input-modern" maxlength="6" placeholder="C√ìDIGO (Ej: ABC123)" style="text-transform:uppercase; letter-spacing:2px; text-align:center;"></div>
      <button id="btnJoinRoom" class="btn-big btn-main btn-primary">ENTRAR</button>
    </div>

    <div id="screenCategories" class="screen" style="display:none;">
      <div class="screen-header">
        <button id="backFromCategories" class="btn-icon-back"><img src="images/arrow.png" class="arrow-icon-img" alt="Volver"></button>
        <h2>Categor√≠as</h2>
      </div>
      <div id="categoriesGrid" class="categories-grid" style="flex:1; align-content:flex-start;"></div>
      <button id="btnSaveCategories" class="btn-big btn-main btn-primary">GUARDAR</button>
    </div>
  </div>

  <main id="mainContent" style="display:none;">
    <div class="main-layout">
      <div class="top-bar">
        <div style="display:flex; align-items:center;"><span style="font-size:0.7rem; color:#94a3b8; font-weight:bold; margin-right:5px;">SALA</span><span id="roomCodeDisplay" class="room-code-display">------</span><button id="btnCopyCode" class="copy-btn-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button></div>
        <span id="phaseLabel" style="background:#1e293b; color:#60a5fa; padding:5px 10px; border-radius:5px; font-weight:bold; font-size:0.8rem;">LOBBY</span>
        <div style="display:flex; gap:10px;">
          <button id="btnDiscord" class="btn-discord" style="display:none;"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="margin-right:5px;"><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.6853-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.419-2.1568 2.419zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.419-2.1568 2.419z"/></svg>Discord</button>
          <button id="btnExit" class="btn-exit-game"><img src="images/arrow.png" class="btn-exit-arrow">Salir</button>
        </div>
      </div>

      <div class="main-grid">
        <section class="view-panel">
          <div id="viewLobby" class="view-card">
            <h2>Esperando...</h2>
            <div class="stats-row"><div class="stat-item"><span id="currentPlayersCount" class="stat-value">1</span><span class="stat-label">Jugadores</span></div><div class="stat-item"><span id="currentImpostorsCount" class="stat-value">1</span><span class="stat-label">Impostores</span></div></div>
            <button id="btnStartRound" class="btn-main btn-primary" style="display:none; width:100%; margin-top:20px;">INICIAR PARTIDA</button>
          </div>
          <div id="viewWord" class="view-card" style="display:none;">
            <div class="secret-card-container" onclick="toggleSecretCard()">
              <div id="secretCardInner" class="secret-card-inner">
                <div class="secret-card-face front"><span style="font-size:3rem;">üîí</span><div style="margin-top:10px; font-size:0.8rem; color:#94a3b8;">TOCA PARA VER</div></div>
                <div class="secret-card-face back"><div id="roleTitle" class="role-badge">ROL</div><div id="secretWordDisplay" class="secret-word-reveal">---</div><p id="wordHint" style="font-size:0.8rem; color:#94a3b8;">...</p></div>
              </div>
            </div>
            <p style="margin-top:20px; color:#94a3b8;">Memoriza tu rol.</p>
          </div>
          <div id="viewTurn" class="view-card" style="display:none;">
            <h2 id="turnTitle">Pistas</h2>
            <div class="app-card" style="text-align:center; margin:20px 0;"><span class="mini-label">TURNO DE</span><div id="currentTurnPlayer" style="font-size:1.5rem; font-weight:bold;">...</div></div>
            <div id="turnActions" style="display:none;"><button id="btnEndTurn" class="btn-main btn-primary">TERMINAR TURNO</button></div>
          </div>
          <div id="viewVote" class="view-card" style="display:none;">
            <h2>Votaci√≥n</h2>
            <p id="voteSubtitle" style="color:#94a3b8; margin-bottom:15px;">Elige al impostor</p>
            <div id="votePlayersGrid" class="categories-grid"></div>
            <button id="btnSkipVote" class="btn-secondary btn-main" style="width:100%; margin-top:20px;">SALTAR (SKIP)</button>
          </div>
        </section>

        <aside class="sidebar-panel" style="display:flex; flex-direction:column; gap:10px;">
          <div class="sidebar-card"><div class="mini-label">TIEMPO</div><div id="timerNumber" class="timer-display-sidebar">--</div></div>
          <div class="sidebar-card" style="flex:1;"><div class="mini-label">AGENTES</div><div id="playersList" class="players-list"></div></div>
          <div class="sidebar-card"><div class="mini-label">ESTADO</div><p id="statusText" style="font-size:0.8rem; color:#94a3b8;">...</p></div>
        </aside>
      </div>
    </div>
  </main>
  <script src="/socket.io/socket.io.js"></script>
  <script src="game.js"></script>
</body>
</html>